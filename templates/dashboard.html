{% extends "base.html" %}

{% block head %}
<link rel="stylesheet" href="/static/css/dashboard.css">
{% endblock %}

{% block content %}
<div class="dashboard">
    <!-- Кнопка "На главную" -->
    <a href="{{ url_for('index') }}" class="back-to-home">
        <i class="fas fa-arrow-left"></i> На главную
    </a>
    <h2>Добро пожаловать, {{ 'username' }}!</h2>
<div class="dashboard-actions">
    <a href="{{ url_for('transport') }}" class="dashboard-btn">
        <i class="fas fa-bus"></i> Советы по транспорту
    </a>
</div>
    <div class="dashboard-grid">
        <div class="weather-box">
            <h3>Погода в Москве</h3>
            <div class="weather-info">
                <p>Температура: {{ weather_data.temp }}°C</p>
                <p>Состояние: {{ weather_data.condition }}</p>
                <p>Влажность: {{ weather_data.humidity }}%</p>
                <p>Ветер: {{ weather_data.wind }} м/с</p>
            </div>
        </div>
        
        <div class="traffic-box">
            <h3>Самые загруженные дороги</h3>
            <table>
                <thead>
                    <tr>
                        <th>Дорога</th>
                        <th>Загруженность</th>
                        <th>Средняя скорость</th>
                    </tr>
                </thead>
                <tbody>
                    {% for road in traffic_data %}
                    <tr>
                        <td>{{ road.road }}</td>
                        <td class="level-{{ road.level }}">{{ road.level }}</td>
                        <td>{{ road.speed }} км/ч</td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
        
        <div class="chat-box">
            <h3>Чат</h3>
            <div id="chat-messages"></div>
            <div class="chat-input">
                <input type="text" id="message-input" placeholder="Введите сообщение">
                <button id="send-button">Отправить</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="https://cdn.socket.io/4.0.1/socket.io.min.js"></script>
<script src="/static/js/chat.js"></script>
{% endblock %}